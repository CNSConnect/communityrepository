if(!this.JSON)this.JSON={};
(function(){function b(a){return 10>a?"0"+a:a}function a(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var d=h[a];return"string"===typeof d?d:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(d,b){var e,l,o,h,p=g,m,j=b[d];j&&"object"===typeof j&&"function"===typeof j.toJSON&&(j=j.toJSON(d));"function"===typeof i&&(j=i.call(b,d,j));switch(typeof j){case "string":return a(j);case "number":return isFinite(j)?""+j:"null";case "boolean":case "null":return""+j;
case "object":if(!j)return"null";g+=f;m=[];if("[object Array]"===Object.prototype.toString.apply(j)){h=j.length;for(e=0;e<h;e+=1)m[e]=c(e,j)||"null";o=0===m.length?"[]":g?"[\n"+g+m.join(",\n"+g)+"\n"+p+"]":"["+m.join(",")+"]";g=p;return o}if(i&&"object"===typeof i){h=i.length;for(e=0;e<h;e+=1)l=i[e],"string"===typeof l&&(o=c(l,j))&&m.push(a(l)+(g?": ":":")+o)}else for(l in j)Object.hasOwnProperty.call(j,l)&&(o=c(l,j))&&m.push(a(l)+(g?": ":":")+o);o=0===m.length?"{}":g?"{\n"+g+m.join(",\n"+g)+"\n"+
p+"}":"{"+m.join(",")+"}";g=p;return o}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,f,h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;if("function"!==typeof JSON.stringify)JSON.stringify=function(a,d,b){var e;f=g="";if("number"===typeof b)for(e=0;e<b;e+=1)f+=" ";else"string"===typeof b&&(f=b);if((i=d)&&"function"!==typeof d&&("object"!==typeof d||"number"!==typeof d.length))throw Error("JSON.stringify");return c("",
{"":a})};if("function"!==typeof JSON.parse)JSON.parse=function(a,b){function c(a,d){var e,g,f=a[d];if(f&&"object"===typeof f)for(e in f)Object.hasOwnProperty.call(f,e)&&(g=c(f,e),void 0!==g?f[e]=g:delete f[e]);return b.call(a,d,f)}var e,a=""+a;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return e=eval("("+a+")"),"function"===typeof b?c({"":e},""):e;throw new SyntaxError("JSON.parse");}})();
(function(b){function a(a){return a&&a.constructor===Number?a+"px":a}b.fn.bgiframe=b.browser.msie&&/msie 6\.0/i.test(navigator.userAgent)?function(c){var c=b.extend({top:"auto",left:"auto",width:"auto",height:"auto",opacity:!0,src:"javascript:false;"},c),d='<iframe class="bgiframe"frameborder="0"tabindex="-1"src="'+c.src+'"style="display:block;position:absolute;z-index:-1;'+(!1!==c.opacity?"filter:Alpha(Opacity='0');":"")+"top:"+("auto"==c.top?"expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')":
a(c.top))+";left:"+("auto"==c.left?"expression(((parseInt(this.parentNode.currentStyle.borderLeftWidth)||0)*-1)+'px')":a(c.left))+";width:"+("auto"==c.width?"expression(this.parentNode.offsetWidth+'px')":a(c.width))+";height:"+("auto"==c.height?"expression(this.parentNode.offsetHeight+'px')":a(c.height))+';"/>';return this.each(function(){0===b(this).children("iframe.bgiframe").length&&this.insertBefore(document.createElement(d),this.firstChild)})}:function(){return this};b.fn.bgIframe=b.fn.bgiframe})(jQuery);
function get_form_values(b){var a={};jQuery(b).find("input,select,textarea").each(function(){if(this.name)if(a[this.name]||(a[this.name]=[]),"select"===this.nodeName.toLowerCase()){var b=a[this.name];$(this).find("option").each(function(){this.selected&&b.push(this.value)})}else"input"===this.nodeName.toLowerCase()&&("checkbox"===this.type||"radio"===this.type)&&!this.checked||a[this.name].push(this.value||"")});return a}
function restore_form_values(b,a){var c=jQuery;c(b).find("input,select,textarea").each(function(){if(this.name){var d=a[this.name];if(!("undefined"==typeof d||null===d))"input"===this.nodeName.toLowerCase()&&("checkbox"===this.type||"radio"===this.type)?this.checked=1<d.length?0<=c.inArray(this.value,d):0==d.length?!1:this.value===d[0]:"select"===this.nodeName.toLowerCase()?c(this).find("option").each(function(){this.selected=1<d.length?0<=c.inArray(this.value,d):0==d.length?!1:this.value===d[0]}):
this.value=d.length?d[0]:""}})}
function init_cached_state(b){var a=jQuery,b=b||"#EntryForm";onbeforeunload_fns=[];onbeforerestorevalues_fns=[];window.onbeforeunload=function(){var c={form_values:get_form_values(b)};a.each(onbeforeunload_fns,function(a,b){b(c)});document.getElementById("cache_form_values").value=JSON.stringify(c)};window.cache_register_onbeforeunload=function(a){onbeforeunload_fns.push(a)};window.cache_register_onbeforerestorevalues=function(a){onbeforerestorevalues_fns.push(a)};window.restore_cached_state=function(){var c=
document.getElementById("cache_form_values");if(c.value){var d=JSON.parse(c.value);a.each(onbeforerestorevalues_fns,function(a,b){b(d)});restore_form_values(b,d.form_values)}}}
(function(){var b=function(a){a=a.toLowerCase();a=a.replace(RegExp("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]","g"),"a");a=a.replace(RegExp("\u00e6","g"),"ae");a=a.replace(RegExp("\u00e7","g"),"c");a=a.replace(RegExp("[\u00e8\u00e9\u00ea\u00eb]","g"),"e");a=a.replace(RegExp("[\u00ec\u00ed\u00ee\u00ef]","g"),"i");a=a.replace(RegExp("\u00f1","g"),"n");a=a.replace(RegExp("[\u00f2\u00f3\u00f4\u00f5\u00f6]","g"),"o");a=a.replace(RegExp("\u009c","g"),"oe");a=a.replace(RegExp("[\u00f9\u00fa\u00fb\u00fc]","g"),
"u");return a=a.replace(RegExp("[\u00fd\u00ff]","g"),"y")};window.string_ci_ai=b;var a=function(a,e,c,f,h){c=c||"value";f=f||"";h=h||"";return function(i,k){if(e.term&&RegExp(f+a.ui.autocomplete.escapeRegex(e.term)+h,"i").test(i.term)&&e.content&&13>e.content.length){var n=RegExp(f+a.ui.autocomplete.escapeRegex(i.term)+h,"i");k(a.grep(e.content,function(a){return n.test(b(a[c]))}));return!0}return!1}};window.default_cache_search_fn=a;var c=function(c,e,g,f,h){g=g||{};h=h||a(c,g,f||"value");return function(a,
f,n){a.term=b(a.term);g.term===a.term&&g.content?f(g.content):h(a,f)||c.ajax({url:n||e,dataType:"json",data:a,cache:!1,success:function(b){g.term=a.term;g.content=b;f(b)}})}};window.create_caching_source_fn=c;window.init_community_autocomplete=function(a,b,g,f){a("#"+b).autocomplete({focus:function(){return!1},source:c(a,g),minLength:f})}})();"undefined"==typeof entryform&&(entryform={});
function create_checklist_onbefore_fns(b,a,c,d){cache_register_onbeforeunload(function(b){b[a+"_added"]=c});cache_register_onbeforerestorevalues(function(c){(c=c[a+"_added"])&&b.each(c,function(a,b){d(b.chkid,b.display,"")})})}
function basic_chk_add_html(b,a){return function(c,d){b("#"+a+"_existing_add_table").append(b("<tr>").append(b("<td>").append(b("<input>").prop({id:a+"_ID_"+c,type:"checkbox",checked:!0,defaultChecked:!0,name:a+"_ID",value:c})).append(document.createTextNode(" "+d))).append(b("<td>").append(b("<input>").prop({id:a+"_NOTES_"+c,name:a+"_NOTES_"+c,size:entryform.chk_notes_size,maxlength:entryform.chk_notes_maxlen}))))}}
function init_autocomplete_checklist(b,a){var c=a.field,d=a.source;a.minLength=a.minLength||1;a.delay=a.delay||300;a.add_new_html=a.add_new_html||basic_chk_add_html(b,c);a.match_prop=a.match_prop||"value";var e=a.added_values||[],g=function(b,d){var f=document.getElementById(c+"_ID_"+b);f?f.checked=!0:(e.push({chkid:b,display:d}),a.add_new_html(b,d))};create_checklist_onbefore_fns(b,c,e,g);var f=b("#NEW_"+c),h={},i=function(){f.data({chkid:"",display:""}).prop("value","").focus();b("#"+c+"_error").hide("slow",
function(){b(this).remove()})},k=null,n=null;(function(c){b.isArray(c)?(n=function(e,d){var f=RegExp(b.ui.autocomplete.escapeRegex(string_ci_ai(e.term)));d(b.grep(c,function(b){return f.test(string_ci_ai(b[a.match_prop]||b))}))},k=function(e,d){var f=string_ci_ai(e),g=b.grep(c,function(b){return string_ci_ai(string_ci_ai(b[a.match_prop]||b))===f});if(1===g.length)return d(g[0]),!0;d()}):"string"===typeof c?(n=create_caching_source_fn(b,c,h,a.match_prop),k=function(c,e,d){var f=string_ci_ai(c);if(h.content){var g=
b.grep(h.content,function(b){return string_ci_ai(b[a.match_prop])===f});if(1===g.length){e(g[0]);return}}d||string_ci_ai(h.term||"")===f?e():n({term:f},function(){k(c,e,!0)})}):(n=c,k=a.look_for_fn)})(d);var q=b("#add_"+c).click(function(){var e=f.data("chkid"),d=f.data("display"),h=f[0].value;e&&d&&d==h?(g(e,d),i()):k(f[0].value,function(e){e?(g(e.chkid,e[a.match_prop]),i()):0===b("#"+c+"_error").length&&(b("#"+c+"_new_input_table").before(b('<div class="ui-widget clearfix" style="margin: 0.25em;">                <div class="ui-state-error error-field-wrapper">                 <span class="ui-icon ui-icon-alert error-notice-icon"></span>[MSG]                </div>            </div>'.replace("[MSG]",
b("<div>").text(a.not_found_msg||"Not Found").html())).hide().prop("id",c+"_error")),b("#"+c+"_error").show("slow"))})});f.autocomplete({focus:function(){return!1},source:n,minLength:a.minLength,delay:a.delay,select:function(b,c){f.data({chkid:c.item.chkid,display:c.item[a.match_prop]})}}).keypress(function(a){"13"==a.keyCode&&(a.preventDefault(),f.autocomplete("close"),q.trigger("click"))})}
function only_items_chk_add_html(b,a,c){return function(d,e){c&&c();b("#"+a+"_existing_add_container").append(b("<input>").prop({id:a+"_ID_"+d,type:"checkbox",checked:!0,defaultChecked:!0,name:a+"_ID",value:d})).append("&nbsp;").append(document.createTextNode(e)).append(" ; ")}}
function init_check_for_autochecklist(b){var a=jQuery,c=function(){return a("<li>").append(a("<span>").data("jump_location",this.id).addClass("UnaddedChecklistJump SimulateLink").append(a(this).parentsUntil("td[data-field-display-name]").parent().data("fieldDisplayName")))},d=a("input[id^=NEW_]");d.length&&(a("#EntryForm").submit(function(e){var g=d.map(function(){return this.value?this:null});if(g.length&&!e.isDefaultPrevented()){if(!confirm(b)){e.preventDefault();a("#SUBMIT_BUTTON").prop("disabled",
!1);var e=a("#unadded_checklist_error_box"),f=a("#unadded_checklist_error_list"),h=e.is(":visible");h&&f.children("ul:first").hide("slow",function(){a(this).remove()});var i=a("<ul>");h&&i.hide();f.append(i);a.each(g.map(c),function(){i.append(this)});h?i.show("slow"):e.show("slow")}}else e.isDefaultPrevented()&&(e=a("#unadded_checklist_error_box"),f=a("#unadded_checklist_error_list"),e.hide("slow",function(){f.children().remove()}))}),a(".UnaddedChecklistJump").live("click",function(){var b=a(this).data("jump_location");
(b=document.getElementById(b))&&b.scrollIntoView(!0)}))}
(function(){var b=jQuery;window.init_municipality_autocomplete=function(a,c,d){a.each(function(){var a={},g=this,f=this.id.replace("Web",""),h=b("#"+f),i=b(this).data("cm_info",{value:this.value,chkid:h[0].value}).autocomplete({focus:function(){return!1},source:create_caching_source_fn(b,c,a),minLength:1}).keypress(function(a){"13"==a.keyCode&&(a.preventDefault(),i.autocomplete("close"))}),k=function(){var c=i.data("cm_info"),f=g.value,l;if(f)if(c&&c.chkid&&c.value&&c.value===f)h[0].value=c.chkid;
else{l=string_ci_ai(f);if(a.content&&(c=b.grep(a.content,function(a){return string_ci_ai(a.value)===l}),1===c.length)){h[0].value=c[0].chkid;i.data("cm_info",c[0]);return}this.focus();alert(d)}else h[0].value=""};i.blur(function(){setTimeout(k,100)})})}})();
(function(){window.init_search_areas_checklist=function(b,a,c){var d={},e=create_caching_source_fn(b,a,d,"label"),g=b("#community_ParentCommunity"),f=9999,h=b("#alt-area-template").html(),i=b("#alt-area-target"),k=function(a,f,g){var h=string_ci_ai(a);if(d.content){var i=b.grep(d.content,function(a){return string_ci_ai(a[c.match_prop])===h});if(1===i.length){f(i[0]);return}}g||string_ci_ai(d.term||"")===h?f():e({term:h},function(){k(a,f,!0)})};c.source=function(a,b,c){a.parent=g.val();return e(a,
b,c)};c.look_for_fn=k;c.add_new_html=function(a,c){to_add=b(h.replace(/\[COUNT\]/g,f++).replace(/\[ID\]/g,a).replace(/\[LABEL\]/g,b("<div>").text(c).html()));i.is(":hidden")?i.removeClass("hidden").append(to_add):i.append(to_add);return!1};init_autocomplete_checklist(b,c)};window.init_community_edit=function(b){var a=9999,c=null,d=null;b("#add-alternate-name").click(function(e){var g=null;e.preventDefault();c||(c=b("#alt-name-template").html(),d=b("#alt-name-target"));g=b(c.replace(/\[COUNT\]/g,a++));
d.is(":hidden")?d.removeClass("hidden").append(g):d.append(g);return!1})}})();
